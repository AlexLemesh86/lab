
**Лабораторная работа. Настройка протокола OSPFv2 для одной области**

# Топология

![image](https://user-images.githubusercontent.com/80053204/122429796-b8aa9680-cf9b-11eb-8a86-05b9d6a80038.png)

# Таблица адресации

| Устройство | Интерфейс | IP-адрес | Маска подсети |
| --- | --- | --- | --- |
| R1 | G0/0/1 | 10.53.0.1 | 255.255.255.0 |
| --- | --- | --- | --- |
| R1 | Loopback1 | 172.16.1.1 | 255.255.255.0 |
| R2 | G0/0/1 | 10.53.0.2 | 255.255.255.0 |
| --- | --- | --- | --- |
| R2 | Loopback1 | 192.168.1.1 | 255.255.255.0 |

# Цели

**Часть 1. Создание сети и настройка основных параметров устройства**

**Часть 2. Настройка и проверка базовой работы протокола OSPFv2 для одной области**

**Часть 3. Оптимизация и проверка конфигурации OSPFv2 для одной области**

# Общие сведения и сценарий

Вам было поручено настроить сеть небольшой компании с помощью OSPFv2. R1 будет размещать интернет-соединение (имитируемое интерфейсом Loopback 1) и делиться информацией о маршруте по умолчанию до R2. После первоначальной настройки организация попросила оптимизировать конфигурацию, чтобы уменьшить трафик протокола и гарантировать, что R1 продолжает контролировать маршрутизацию.

**Примечание.** Статическая маршрутизация, используемая в данной лаборатории, заключается в оценке возможности настройки и настройки OSPFv2 в конфигурации для одной области. Этот подход, используемый в данной лаборатории, может не отражать рекомендации по работе с сетевыми сетями.

**Примечание** : Маршрутизаторы, используемые в практических лабораторных работах CCNA, - это Cisco 4221 с Cisco IOS XE Release 16.9.4 (образ universalk9). В лабораторных работах используются коммутаторы Cisco Catalyst 2960 с Cisco IOS версии 15.2(2) (образ lanbasek9). Можно использовать другие маршрутизаторы, коммутаторы и версии Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах. Правильные идентификаторы интерфейса см. в сводной таблице по интерфейсам маршрутизаторов в конце лабораторной работы.

**Примечание.** Убедитесь, что у всех маршрутизаторов и коммутаторов была удалена начальная конфигурация. Если вы не уверены в этом, обратитесь к инструктору.

# Необходимые ресурсы

- 2 маршрутизатора (Cisco 4221 с универсальным образом Cisco IOS XE версии 16.9.4 или аналогичным)
- 2 коммутатора (Cisco 2960 с операционной системой Cisco IOS 15.2(2) (образ lanbasek9) или аналогичная модель)
- 1 ПК (под управлением Windows с программой эмуляции терминала, например, Tera Term)
- Консольные кабели для настройки устройств Cisco IOS через консольные порты.
- Кабели Ethernet, расположенные в соответствии с топологией

# Инструкции

## Создание сети и настройка основных параметров устройства

### Создайте сеть согласно топологии.

Подключите устройства, как показано в топологии, и подсоедините необходимые кабели.

### Произведите базовую настройку маршрутизаторов.

Откройте окно конфигурации

      1. Назначьте маршрутизатору имя устройства.
      2. Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.
      3. Назначьте **class** в качестве зашифрованного пароля привилегированного режима EXEC.
      4. Назначьте **cisco** в качестве пароля консоли и включите вход в систему по паролю.
      5. Назначьте **cisco** в качестве пароля VTY и включите вход в систему по паролю.
      6. Зашифруйте открытые пароли.
      7. Создайте баннер с предупреждением о запрете несанкционированного доступа к устройству.
      8. Сохраните текущую конфигурацию в файл загрузочной конфигурации.
### Настройте базовые параметры каждого коммутатора.

      1. Назначьте коммутатору имя устройства.
      2. Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.
      3. Назначьте **class** в качестве зашифрованного пароля привилегированного режима EXEC.
      4. Назначьте **cisco** в качестве пароля консоли и включите вход в систему по паролю.
      5. Назначьте **cisco** в качестве пароля VTY и включите вход в систему по паролю.
      6. Зашифруйте открытые пароли.
      7. Создайте баннер с предупреждением о запрете несанкционированного доступа к устройству.
      8. Сохраните текущую конфигурацию в файл загрузочной конфигурации.

Закройте окно настройки.

## Настройка и проверка базовой работы протокола OSPFv2 для одной области

### Настройте адреса интерфейса и базового OSPFv2 на каждом маршрутизаторе.

      1. Настройте адреса интерфейсов на каждом маршрутизаторе, как показано в таблице адресации выше.

![image](https://user-images.githubusercontent.com/80053204/122429951-daa41900-cf9b-11eb-9ddc-a8181f5356bd.png)

![image](https://user-images.githubusercontent.com/80053204/122429969-df68cd00-cf9b-11eb-9a0d-977f9ad71e4a.png)

![image](https://user-images.githubusercontent.com/80053204/122430011-e5f74480-cf9b-11eb-9ba5-97b3de4abff0.png)

![image](https://user-images.githubusercontent.com/80053204/122430057-f0194300-cf9b-11eb-9399-28e4fd70d9eb.png)

Откройте окно конфигурации

      1. Перейдите в режим конфигурации маршрутизатора OSPF, используя идентификатор процесса 56.

![image](https://user-images.githubusercontent.com/80053204/122430108-f9a2ab00-cf9b-11eb-952a-74754f5353d8.png)

![image](https://user-images.githubusercontent.com/80053204/122430142-fefff580-cf9b-11eb-83ad-57730ce608f2.png)

      1. Настройте статический идентификатор маршрутизатора для каждого маршрутизатора (1.1.1.1 для R1, 2.2.2.2 для R2).

![image](https://user-images.githubusercontent.com/80053204/122430178-06bf9a00-cf9c-11eb-91cb-caf1009bd213.png)

![image](https://user-images.githubusercontent.com/80053204/122430185-0a532100-cf9c-11eb-9bba-cc0cd41bd522.png)

      1. Настройте инструкцию сети для сети между R1 и R2, поместив ее в область 0.

![image](https://user-images.githubusercontent.com/80053204/122430217-15a64c80-cf9c-11eb-8c14-32a9558419c6.png)

![image](https://user-images.githubusercontent.com/80053204/122430251-1ccd5a80-cf9c-11eb-99d2-adab28bbfc72.png)

      1. Только на R2 добавьте конфигурацию, необходимую для объявления сети Loopback 1 в область OSPF 0.

![image](https://user-images.githubusercontent.com/80053204/122430300-25be2c00-cf9c-11eb-819d-597190203d9d.png)

      1. Убедитесь, что OSPFv2 работает между маршрутизаторами. Выполните команду, чтобы убедиться, что R1 и R2 сформировали смежность.

![image](https://user-images.githubusercontent.com/80053204/122430329-2d7dd080-cf9c-11eb-8d3f-1344f9c7770d.png)

![image](https://user-images.githubusercontent.com/80053204/122430370-37073880-cf9c-11eb-8510-dfba412918fe.png)

#### Вопрос:

Какой маршрутизатор является DR? Какой маршрутизатор является BDR? Каковы критерии отбора?

Ответ: R1 – DR, R2 - BDR

      1. На R1 выполните команду **show ip route ospf** , чтобы убедиться, что сеть R2 Loopback1 присутствует в таблице маршрутизации. Обратите внимание, что поведение OSPF по умолчанию заключается в объявлении интерфейса обратной связи в качестве маршрута узла с использованием 32-битной маски.

![image](https://user-images.githubusercontent.com/80053204/122430418-42f2fa80-cf9c-11eb-91ee-c9d2c9731b83.png)

      1. Запустите Ping до адреса интерфейса R2 Loopback 1 из R1. Выполнение команды ping должно быть успешным.

![image](https://user-images.githubusercontent.com/80053204/122430453-4a1a0880-cf9c-11eb-9315-7f67a193214b.png)

Закройте окно настройки.

## Оптимизация и проверка конфигурации OSPFv2 для одной области

### Реализация различных оптимизаций на каждом маршрутизаторе.

Откройте окно конфигурации

      1. На R1 настройте приоритет OSPF интерфейса G0/0/1 на 50, чтобы убедиться, что R1 является назначенным маршрутизатором.

![image](https://user-images.githubusercontent.com/80053204/122430504-569e6100-cf9c-11eb-848d-2aea71ce1549.png)

      1. Настройте таймеры OSPF на G0/0/1 каждого маршрутизатора для таймера приветствия, составляющего 30 секунд.

![image](https://user-images.githubusercontent.com/80053204/122430543-5f8f3280-cf9c-11eb-8504-23dd1ef78e63.png)

![image](https://user-images.githubusercontent.com/80053204/122430578-661daa00-cf9c-11eb-9e93-3c6e2eaa067f.png)

      1. На R1 настройте статический маршрут по умолчанию, который использует интерфейс Loopback 1 в качестве интерфейса выхода. Затем распространите маршрут по умолчанию в OSPF. Обратите внимание на сообщение консоли после установки маршрута по умолчанию.

![image](https://user-images.githubusercontent.com/80053204/122430641-733a9900-cf9c-11eb-9a32-03000d49656e.png)

      1. добавьте конфигурацию, необходимую для OSPF для обработки R2 Loopback 1 как сети точка-точка. Это приводит к тому, что OSPF объявляет Loopback 1 использует маску подсети интерфейса.

![image](https://user-images.githubusercontent.com/80053204/122430784-8e0d0d80-cf9c-11eb-8f1a-43d651ac1eaf.png)

      1. Только на R2 добавьте конфигурацию, необходимую для предотвращения отправки объявлений OSPF в сеть Loopback 1.

![image](https://user-images.githubusercontent.com/80053204/122430814-949b8500-cf9c-11eb-9504-8b1cdd63d980.png)

      1. Измените базовую пропускную способность для маршрутизаторов. После этой настройки перезапустите OSPF с помощью команды **clear ip ospf process**. Обратите внимание на сообщение консоли после установки новой опорной полосы пропускания.

![image](https://user-images.githubusercontent.com/80053204/122430861-9d8c5680-cf9c-11eb-9f1f-8e05a2057245.png)

![image](https://user-images.githubusercontent.com/80053204/122430878-a11fdd80-cf9c-11eb-9ea8-e33225b936da.png)

![image](https://user-images.githubusercontent.com/80053204/122430901-a715be80-cf9c-11eb-9745-55b68816ba5a.png)

### Убедитесь, что оптимизация OSPFv2 реализовалась.

      1. Выполните команду **show ip ospf interface g0/0/1** на R1 и убедитесь, что приоритет интерфейса установлен равным 50, а временные интервалы — Hello 30, Dead 40, а тип сети по умолчанию — Broadcast

![image](https://user-images.githubusercontent.com/80053204/122430963-b3018080-cf9c-11eb-965c-ea237f7396e4.png)

      1. На R1 выполните команду **show ip route ospf** , чтобы убедиться, что сеть R2 Loopback1 присутствует в таблице маршрутизации. Обратите внимание на разницу в метрике между этим выходным и предыдущим выходным. Также обратите внимание, что маска теперь составляет 24 бита, в отличие от 32 битов, ранее объявленных.

![image](https://user-images.githubusercontent.com/80053204/122431083-cd3b5e80-cf9c-11eb-807c-583daf7fb0b2.png)

      1. Введите команду **show ip route ospf** на маршрутизаторе R2. Единственная информация о маршруте OSPF должна быть распространяемый по умолчанию маршрут R1.

      1. Запустите Ping до адреса интерфейса R1 Loopback 1 из R2. Выполнение команды ping должно быть успешным.

#### Вопрос:

Почему стоимость OSPF для маршрута по умолчанию отличается от стоимости OSPF в R1 для сети 192.168.1.0/24?

Закройте окно настройки.

# Сводная таблица по интерфейсам маршрутизаторов

|

Модель маршрутизатора

 |

Интерфейс Ethernet № 1

 |

Интерфейс Ethernet № 2

 |

Последовательный интерфейс № 1

 |

Последовательный интерфейс № 2

 |
| --- | --- | --- | --- | --- |
| 1 800 | Fast Ethernet 0/0 (F0/0) | Fast Ethernet 0/1 (F0/1) | Serial 0/0/0 (S0/0/0) | Serial 0/0/1 (S0/0/1) |
| --- | --- | --- | --- | --- |
| 1900 | Gigabit Ethernet 0/0 (G0/0) | Gigabit Ethernet 0/1 (G0/1) | Serial 0/0/0 (S0/0/0) | Serial 0/0/1 (S0/0/1) |
| 2801 | Fast Ethernet 0/0 (F0/0) | Fast Ethernet 0/1 (F0/1) | Serial 0/1/0 (S0/1/0) | Serial 0/1/1 (S0/1/1) |
| 2811 | Fast Ethernet 0/0 (F0/0) | Fast Ethernet 0/1 (F0/1) | Serial 0/0/0 (S0/0/0) | Serial 0/0/1 (S0/0/1) |
| 2900 | Gigabit Ethernet 0/0 (G0/0) | Gigabit Ethernet 0/1 (G0/1) | Serial 0/0/0 (S0/0/0) | Serial 0/0/1 (S0/0/1) |
| 4221 | Gigabit Ethernet 0/0/0 (G0/0/0) | Gigabit Ethernet 0/0/1 (G0/0/1) | Serial 0/1/0 (S0/1/0) | Serial 0/1/1 (S0/1/1) |
| 4300 | Gigabit Ethernet 0/0/0 (G0/0/0) | Gigabit Ethernet 0/0/1 (G0/0/1) | Serial 0/1/0 (S0/1/0) | Serial 0/1/1 (S0/1/1) |

**Примечание**. Чтобы определить конфигурацию маршрутизатора, можно посмотреть на интерфейсы и установить тип маршрутизатора и количество его интерфейсов. Перечислить все комбинации конфигураций для каждого класса маршрутизаторов невозможно. Эта таблица содержит идентификаторы для возможных комбинаций интерфейсов Ethernet и последовательных интерфейсов на устройстве. Другие типы интерфейсов в таблице не представлены, хотя они могут присутствовать в данном конкретном маршрутизаторе. В качестве примера можно привести интерфейс ISDN BRI. Строка в скобках — это официальное сокращение, которое можно использовать в командах Cisco IOS для обозначения интерфейса.

Конец документа

©  2019 г. - гггг Корпорация Cisco и/или ее дочерние компании. Все права защищены. Открытая информация Cisco страница **1**** 5**www.netacad.com
